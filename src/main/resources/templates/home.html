<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/">ç­‹ãƒˆãƒ¬ç®¡ç†ã‚¢ãƒ—ãƒª</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="/training/record">è¨˜éŒ²ã™ã‚‹</a></li>
        <li class="nav-item"><a class="nav-link" href="/training/history">å±¥æ­´</a></li>
        <li class="nav-item">
          <form th:action="@{/logout}" method="post" class="d-inline">
            <button class="btn nav-link border-0 bg-transparent" type="submit">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
          </form>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="h4 fw-bold mb-0">ã‚ˆã†ã“ã  <span th:text="${#authentication.name}">User</span> ã•ã‚“</h2>
  </div>

  <div class="row g-4"> <div class="col-lg-8 col-md-12">
    <div class="d-grid gap-2 mb-4">
      <a href="/training/record" class="btn btn-primary btn-lg py-3 shadow-sm">
        <span class="fs-4">ğŸ‹ï¸ ä»Šæ—¥ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¨˜éŒ²</span>
      </a>
    </div>

    <div class="card h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <span>ğŸ“Š ãƒœãƒªãƒ¥ãƒ¼ãƒ æ¨ç§»</span>
        <small class="text-muted">éå»1é€±é–“</small>
      </div>
      <div class="card-body">
        <canvas id="loadChart" style="max-height: 300px;"></canvas>
      </div>
    </div>
  </div>

    <div class="col-lg-4 col-md-12">

      <div class="card text-center mb-4">
        <div class="card-header bg-dark text-white border-0">
          æœ¬æ—¥ã®ç·è² è·é‡
        </div>
        <div class="card-body">
          <h3 class="display-3 fw-bold my-2" th:text="${totalLoad}">0</h3>
          <span class="text-muted fs-5">kg</span>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          ğŸ•’ æœ€è¿‘ã®å±¥æ­´
        </div>
        <ul class="list-group list-group-flush" th:if="${not #lists.isEmpty(recentHistory)}">
          <li class="list-group-item" th:each="h : ${recentHistory}">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <small class="text-muted d-block" th:text="${h.memo.training.trainingDay}">Date</small>
                <strong th:text="${h.memo.exercise.exerciseName}">ç¨®ç›®</strong>
              </div>
              <div class="text-end">
                        <span class="badge bg-light text-dark border">
                            <span th:text="${h.weight}">60</span>kg
                        </span>
                <div class="small mt-1">
                  <span th:text="${h.rep}">10</span>rep Ã— <span th:text="${h.setCount}">3</span>set
                </div>
              </div>
            </div>
          </li>
        </ul>
        <div class="card-body text-center" th:if="${#lists.isEmpty(recentHistory)}">
          <p class="text-muted">ã¾ã å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</p>
        </div>
        <div class="card-footer bg-white text-center border-0">
          <a href="/training/history" class="btn btn-outline-secondary btn-sm w-100">å…¨ã¦ã®å±¥æ­´ã‚’è¦‹ã‚‹</a>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/main.js"></script>
<script th:inline="javascript">
  const ctx = document.getElementById('loadChart').getContext('2d');
  const labels = /*[[${chartLabels}]]*/ [];
  const dataValues = /*[[${chartValues}]]*/ [];

  new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: 'Volume (kg)',
        data: dataValues,
        borderColor: '#0d6efd',
        backgroundColor: 'rgba(13, 110, 253, 0.1)',
        borderWidth: 2,
        pointRadius: 4,
        tension: 0.1,
        fill: true
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true, grid: { borderDash: [2, 4] } }, x: { grid: { display: false } } }
    }
  });
</script>

</body>
</html>